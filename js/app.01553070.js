(function(e){function t(t){for(var o,s,a=t[0],u=t[1],c=t[2],d=0,f=[];d<a.length;d++)s=a[d],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&f.push(i[s][0]),i[s]=0;for(o in u)Object.prototype.hasOwnProperty.call(u,o)&&(e[o]=u[o]);l&&l(t);while(f.length)f.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],o=!0,a=1;a<n.length;a++){var u=n[a];0!==i[u]&&(o=!1)}o&&(r.splice(t--,1),e=s(s.s=n[0]))}return e}var o={},i={app:0},r=[];function s(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=o,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(n,o,function(t){return e[t]}.bind(null,o));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/Movie-Quiz/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],u=a.push.bind(a);a.push=t,a=a.slice();for(var c=0;c<a.length;c++)t(a[c]);var l=u;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"01cf":function(e,t,n){"use strict";var o=n("b272"),i=n.n(o);i.a},"034f":function(e,t,n){"use strict";var o=n("85ec"),i=n.n(o);i.a},"126f":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("a026"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},r=[],s=(n("96cf"),n("1da1")),a={name:"App",created:function(){var e=this;this.$axios.interceptors.response.use((function(t){if(console.log("response:",t),t.data&&401===t.data.status&&(localStorage.removeItem("auth-token"),e.$router.push("/signin")),t.data&&t.data.errorMessage)throw console.error(t.data),t.data;return t.data}),function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.$axios.interceptors.request.use((function(e){var t=localStorage.getItem("auth-token");return t&&(e.headers["Authorization"]=t),e}))}},u=a,c=(n("034f"),n("2877")),l=Object(c["a"])(u,i,r,!1,null,null,null),d=l.exports,f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("site-header"),n("h1",[e._v("Home")]),n("div",{staticClass:"stats"},[e._v("Stats:")]),e._m(0)],1)},h=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("footer",[n("div",{staticClass:"tmdb"})])}],p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("header",[n("div",{on:{click:e.onHome}},[e._v("Home")]),n("div",{on:{click:e.onChallenge}},[e._v("Challenge")]),n("div",{on:{click:e.onLogout}},[e._v("Logout")])])},v=[],g={name:"SiteHeader",methods:{onHome:function(){this.$router.push("/home")},onChallenge:function(){this.$router.push("/challenge")},onLogout:function(){var e=this;this.$axios.put("/api/auth/logout").then((function(){localStorage.removeItem("auth-token"),e.$router.push("/signin")}))}}},m=g,_=(n("e3c4"),Object(c["a"])(m,p,v,!1,null,null,null)),b=_.exports,q={name:"Home",components:{SiteHeader:b}},w=q,y=(n("8b71"),Object(c["a"])(w,f,h,!1,null,null,null)),S=y.exports,k=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h1",{staticClass:"title"},[e._v("The movie challenge")]),n("h2",[e._v("Sign in with:")]),n("div",{staticClass:"btn-cnt",on:{click:e.clickGoogleAuth}},[n("div",{staticClass:"google-label",on:{click:e.clickGoogleAuth}},[e._v("Google")])])])},x=[],I={name:"Signin",data:function(){return{}},methods:{clickGoogleAuth:function(){var e=this;this.$gAuth.getAuthCode().then((function(t){return console.log(t),e.$axios.post("/api/auth/google",{code:t})})).then((function(t){console.log("Auth token received",t.auth_token);var n=t.auth_token;localStorage.setItem("auth-token",n),console.log("Checking localStorage auth_token",localStorage.getItem("auth-token")),e.$router.push("/home")})).catch((function(e){console.error(e)}))}}},$=I,C=(n("6d1e"),Object(c["a"])($,k,x,!1,null,null,null)),O=C.exports,j=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("site-header"),n("h1",[e._v("Challenge")]),e.question?n("div",{staticClass:"quest-img-cont"},e._l(e.question.images,(function(t,o){return n("div",{key:"image-"+o},[n("img",{attrs:{src:e._f("fullImgSrc")(t),alt:"image-"+o}})])})),0):e.waitingInfo?n("div",[n("div",[e._v(e._s("Users count: "+e.waitingInfo.count))]),n("div",[e._v(e._s("Users required: "+e.waitingInfo.required))])]):n("div",[e._v(" Loading ... ")]),e.question?n("h1",{attrs:{id:"counter"}},[e._v(e._s(e._f("timeFormat")(e.question.time_left))+" ")]):e._e(),e.question?n("div",[n("div",{staticClass:"guess-film"},[e._v(e._s("Guess the film title ("+e.question.film_title+")"))]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.answer,expression:"answer"}],attrs:{disabled:0===e.question.time_left||e.answerSent,type:"text",id:"answer-input"},domProps:{value:e.answer},on:{input:function(t){t.target.composing||(e.answer=t.target.value)}}}),n("button",{attrs:{disabled:0===e.question.time_left||e.answerSent},on:{click:e.sendAnswer}},[e._v("Send")])]):e._e()],1)},A=[],E=n("782e"),H=n.n(E),P=new H.a("2e0abd87569c657457fa",{cluster:"eu",forceTLS:!0});console.log(P);var z={name:"Challenge",components:{SiteHeader:b},data:function(){return{question:void 0,waitingInfo:void 0,quest_id:void 0,result:void 0,answer:"",answerSent:!1}},created:function(){this.startChallenge()},beforeDestroy:function(){clearInterval(this.timer)},methods:{sendAnswer:function(){this.answerSent=!0,this.$axios.post("/api/quiz",{answer:this.answer?this.answer:" ",quest_id:this.quest_id}).catch((function(e){console.error(e)}))},startChallenge:function(){var e=this;this.question=void 0,this.waitingInfo=void 0,this.quest_id=void 0,this.result=void 0,this.answer="",this.answerSent=!1,this.$axios.get("/api/quiz").then((function(t){console.log(t),null!==t?"Question was closed!"!==t.body.message?t.body.question?(e.question=t.body.question,e.quest_id=t.body.question.quest_id):(e.waitingInfo=t.body,e.quest_id=e.waitingInfo.quest_id):e.$axios.get("/api/quiz").then((function(t){t.body.question?(e.question=t.body.question,e.quest_id=t.body.question.quest_id):(e.waitingInfo=t.body,e.quest_id=e.waitingInfo.quest_id)})):e.$axios.get("/api/quiz").then((function(t){t.body.question&&(e.question=t.body.question,e.quest_id=t.body.question.quest_id)}))})),this.timer=setInterval((function(){if(e.question)return e.question.time_left<=0?(clearInterval(e.timer),void e.sendAnswer(e.answer)):void e.question.time_left--}),1e3)}},filters:{fullImgSrc:function(e){return"https://image.tmdb.org/t/p/w300_and_h450_bestv2/"+e},timeFormat:function(e){var t=Math.floor(e/60),n=""+(e-60*t);return 1===n.length&&(n="0"+n),t+":"+n}},watch:{quest_id:function(e,t){var n=this;if(e){console.log("Old",t),console.log("Current",e);var o=P.subscribe(e);o.bind("new-member",(function(e){console.log("new-member",e),n.waitingInfo=e})),o.bind("question-started",(function(e){console.log("question-started",e),n.question=e.question,n.quest_id=e.question.quest_id})),o.bind("question-finished",(function(e){P.unsubscribe(e.quest_id),console.log("question-finished",e.film_title);var t=confirm(e.film_title);t?n.startChallenge():n.$router.push("/home")}))}}}},M=z,L=(n("01cf"),Object(c["a"])(M,j,A,!1,null,null,null)),G=L.exports,T=n("8c4f"),Q=n("c9bf"),R=n("bc3a"),U=n.n(R);o["a"].config.productionTip=!1;var F={clientId:"99787422901-8i0bebl58png79lcl1vqushprlmufc20.apps.googleusercontent.com",scope:"profile email",prompt:"select_account"};o["a"].use(Q["a"],F),o["a"].use(T["a"]),o["a"].prototype.$axios=U.a.create({baseURL:"https://d0s8asa2p7.execute-api.us-east-1.amazonaws.com/MovieQuizAPI_v1"});var J=function(e,t,n){localStorage.getItem("auth-token")?n():n("/signin")},D=function(e,t,n){localStorage.getItem("auth-token")?n("/"):n()};new o["a"]({el:"#app",components:{App:d},template:"<App/>",axios:U.a,router:new T["a"]({routes:[{path:"/",redirect:"/home"},{path:"/signin",name:"Signin",beforeEnter:D,component:O},{path:"/home",name:"Home",beforeEnter:J,component:S},{path:"/challenge",name:"Challenge",beforeEnter:J,component:G}]})})},"6d1e":function(e,t,n){"use strict";var o=n("126f"),i=n.n(o);i.a},"85ec":function(e,t,n){},"88d7":function(e,t,n){},"8b71":function(e,t,n){"use strict";var o=n("88d7"),i=n.n(o);i.a},b272:function(e,t,n){},cc1b:function(e,t,n){},e3c4:function(e,t,n){"use strict";var o=n("cc1b"),i=n.n(o);i.a}});
//# sourceMappingURL=app.01553070.js.map